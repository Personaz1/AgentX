# [2025-04-20] Выполнено: массовый рефакторинг темы и типизации UI
# [2025-04-20] Выполнено: массовый рефакторинг интеграционных тестов Codex (CodexIntegration.test.tsx, CodexPage.test.tsx)
- Все fireEvent для select/input заменены на userEvent, поиск элементов приведён к getByLabelText.
- Исправлены тесты для работы с MUI Select.
- Все тесты теперь используют userEvent для интеракций.
- Проведена проверка на отсутствие fireEvent в тестах (grep).
- Исправлены ошибки импорта и типизации в тестах.
- Следующий шаг: прогнать тесты и убедиться в их прохождении без ошибок.
- Все обращения props.theme.colors.* заменены на props.theme.* (text, bg, border, accent и т.д.)
- Исправлены типы и обращения к полям в IncidentDetailsPage.tsx, IncidentsManagementPage.tsx
- Критические ошибки по теме и типам устранены, UI собирается
- Следующий этап: массовый рефакторинг тестов, исправление generic-ошибок, null-ов, импортов типов
- План и dev-notes обновлены
# [2025-04-22] SecurityPage: тесты зелёные, эксплойты отображаются
- Реализован badge 'Есть эксплойт' для уязвимостей с публичным эксплойтом
- Все тесты SecurityPage синхронизированы с UI и проходят без ошибок
- Исправлены ошибки поиска по дублирующимся элементам (getAllByText, getByRole с level)
- Следующий шаг: массовый рефакторинг и покрытие тестами остальных страниц (Incidents, Zonds, IntrusionDetection)
# [2025-04-22] IncidentsManagementPage: полный успех
- Проведён рефакторинг и расширение тестов
- Покрытие: поиск, фильтрация, статистика, действия, пустое состояние
- Все тесты зелёные, ошибок нет
- Линтер-ошибки устранены, jsdom-окружение настроено
- Следующий шаг: рефакторинг и тесты следующей страницы по приоритету
# [2025-04-22] IncidentsPage: полный успех
- Проведён рефакторинг и расширение тестов
- Покрытие: поиск, фильтрация, статистика, переходы, пагинация
- Все тесты зелёные, ошибок нет
- Следующий шаг: рефакторинг и тесты следующей страницы (IncidentsManagementPage или по приоритету)
# [2025-04-23] IntrusionDetectionPage: полный успех
- Проведён рефакторинг доступности и тестов
- Покрытие: поиск, фильтрация, раскрытие деталей, MITRE, таблица активности, пагинация
- Все тесты зелёные, ошибок нет
- Конфликт .ts/.tsx устранён, осталась только .tsx-версия
- Следующий шаг: массовый рефакторинг и тесты следующей страницы (Incidents или по приоритету)
# [2025-04-24] ZondsManagementPage: полный успех
- Проведён рефакторинг тестов и доступности (aria-label, data-testid)
- Покрытие: поиск, фильтрация, статистика, действия, пустое состояние, асинхронные сценарии
- Все тесты зелёные, ошибок нет
- Используются реальные таймеры для асинхронных сценариев
- UI и тесты соответствуют best practices по доступности и надёжности
- Блок UI полностью стабилен
- Следующий шаг: ревизия, фиксация прогресса, переход к новому приоритету

# ПЛАН ПО СПАСЕНИЮ UI (NeuroRAT)

## Цель
Привести фронтенд к рабочему состоянию: чтобы проект собирался, тесты запускались, UI был типизирован и не падал по ошибкам темы/типов.

---

## 1. Массовый рефакторинг темы (theme)
- [x] Привести типизацию темы к строгой структуре (styled.d.ts = ThemeColors из theme.ts).
- [ ] Во всех страницах и компонентах заменить:
    - `props.theme.colors.text.primary` → `props.theme.text.primary`
    - `props.theme.colors.background.secondary` → `props.theme.bg.secondary`
    - `props.theme.colors.border.primary` → `props.theme.border.primary`
    - и т.д. (убрать `.colors.` и `.background.`)
- [ ] Проверить и унифицировать все обращения к теме (bg, text, border, accent, success, warning, danger, info).

## 2. Исправление ошибок типов и импорта
- [ ] Исправить импорты типов (например, ZondProps, Incident и др.).
- [ ] Проверить и унифицировать все enum/типовые конструкции (не использовать enum как компонент в JSX).
- [ ] Проверить и исправить все интерфейсы пропсов.

## 3. Починка тестов
- [ ] В тестах заменить использование компонента как типа на `typeof Component`.
- [ ] Исправить generic-ошибки и null-ы.
- [ ] Проверить корректность моков и рендеринга.

## 4. Проверка сборки и тестов
- [ ] Прогнать билд и тесты, собрать новый список ошибок.
- [ ] Исправить критичные ошибки, повторить цикл до чистой сборки.

## 5. Документация и фиксация
- [ ] Обновить dev-notes и этот план по итогам каждого крупного этапа.
- [ ] Зафиксировать, какие страницы/модули работают, какие временно закомментированы.

---

## Приоритеты
1. Массовый рефакторинг темы и типизации (чтобы убрать 90% ошибок).
2. Починка тестов (чтобы CI не падал).
3. Проверка и фиксация рабочих страниц.

---

## Принципы
- Не удалять бизнес-логику и уникальные компоненты — только рефакторить.
- Всё, что не удаётся быстро починить — временно закомментировать, но не удалять.
- Не останавливаться после каждого шага — работать пакетно.
- После каждого крупного этапа — обновлять этот план и dev-notes.

---

## Контроль
- После каждого блока правок — прогонять билд и тесты.
- Вести лог изменений и фиксаций.
- Держать владельца проекта в курсе прогресса.

---

**Этот план — твой щит и меч. Мы не сдаёмся. Мы спасём этот фронт.**

---

## План наведения порядка в UI/админ-панели NeuroRAT/NeuroZond

### 1. Страницы (routes)
- Дашборд: `/`, `/dashboard` — Dashboard.tsx
- Зонды: `/zonds` — ZondsManagementPage.tsx, ZondsPage.tsx, ZondsList.tsx
- Инциденты: `/incidents` — IncidentsListPage.tsx, IncidentsPage.tsx, IncidentDetailsPage.tsx, NewIncidentPage.tsx, IncidentMapPage.tsx
- Аномалии: `/anomalies` — AnomalyDetectionPage.tsx, AnomaliesPage.tsx, AnomalyDetailsPage.tsx
- C1Brain: `/c1brain` — C1BrainPage.tsx
- Codex: `/codex` — CodexPage.tsx
- Security: `/security` — SecurityPage.tsx
- Операции: `/operations`, `/tasks` — TasksPage.tsx, TasksList.tsx
- ATS: `/ats` — ATSPage.tsx, ATSOperationsPage.tsx, BankConfigsPage.tsx
- Отчёты: `/reports` — ReportsPage.tsx
- Настройки: `/settings` — SettingsPage.tsx
- Логин: `/login` — LoginPage.tsx
- 404: NotFoundPage.tsx

### 2. Навигация
- Sidebar (styled-components) — основная панель, все ключевые разделы.
- TopBar/Navbar — привести к единому стилю, убрать дублирование.
- Проверить, чтобы все основные страницы были доступны из Sidebar.

### 3. Темы
- Привести к единому стилю: либо Chakra, либо styled-components (лучше styled-components для кастомизации).
- Удалить дублирующие темы и неиспользуемые ThemeProvider.

### 4. Маршруты
- Проверить все маршруты в App.tsx, добавить недостающие (ATS, BankConfigs, Reports и др.).
- Для страниц-деталей (инцидент, аномалия) — предусмотреть переходы из списков.

### 5. Зависимости
- Проверить package.json: удалить неиспользуемые пакеты, обновить версии, убрать дубли.
- Проверить импорты во всех компонентах.

### 6. UI/UX
- Проверить, чтобы все страницы были стилистически едины.
- Проверить работу всех ссылок, переходов, отображение ошибок/пустых состояний.

### 7. Удалить/интегрировать лишнее
- TasksList, ZondsList — интегрировать или удалить.
- Удалить неиспользуемые компоненты/стили.

### 8. Тесты
- После каждого этапа — запускать тесты, фиксировать прогресс.

---

**Следующий шаг:**
1. Привести Sidebar к финальному виду (все основные страницы, убрать дубли).
2. Привести TopBar/Navbar к единому стилю.
3. Обновить маршруты в App.tsx.
4. После этого — массовый рефакторинг тем и зависимостей. 