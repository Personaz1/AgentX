# Руководство по интеграции с Gemini API в проекте NeuroRAT

## Обзор

Интеграция с Google Gemini API позволяет вашему NeuroRAT агенту использовать передовые возможности многомодальных моделей для:

- Генерации текста с высоким уровнем понимания контекста
- Анализа изображений и видео
- Генерации изображений (экспериментальная функция)
- Потоковой обработки запросов (streaming)
- Улучшенных возможностей автономного принятия решений

## Настройка API ключа

1. Создайте API ключ Google AI Studio: https://ai.google.dev/
2. Обновите файл `.env` с необходимыми переменными:

```
GEMINI_API_KEY
GEMINI_MODEL
```

Значения настоящего ключа и модели должны быть указаны в вашем `.env` файле.

## Использование в коде

### Базовое использование

```python
from api_integration import APIFactory

# Получите экземпляр интеграции
gemini = APIFactory.get_gemini_integration()

# Проверьте доступность
if gemini.is_available():
    # Генерация текста
    response = gemini.generate_response(
        "Проанализируй защиту системы и найди уязвимости",
        system_prompt="Ты - опытный эксперт по кибербезопасности"
    )
    print(response)
```

### Потоковая генерация

```python
# Потоковая генерация ответа (выводит результат по мере генерации)
response = gemini.generate_response(
    "Напиши исчерпывающий отчет о системе",
    system_prompt="Ты - опытный аналитик",
    stream=True
)
```

### Генерация изображений (экспериментальная функция)

```python
# Создание изображения
result = gemini.generate_image("Изображение рабочего стола с кодом на экране")

if "error" not in result:
    # Путь к созданному изображению
    image_path = result["image_path"]
    print(f"Изображение сохранено в: {image_path}")
```

## Интеграция с NeuroRAT

Модуль `api_integration.py` обеспечивает бесшовную интеграцию Gemini API с системой NeuroRAT через `APIFactory`. Основные компоненты системы, которые могут использовать эту интеграцию:

1. **Autonomous Brain** - для улучшенного принятия решений
2. **LLM Processor** - для обработки запросов на естественном языке
3. **Server API** - для обработки команд от C2 сервера
4. **Agent Modules** - для расширения возможностей агентов

## Рекомендуемые модели и их возможности

В проекте NeuroRAT мы рекомендуем использовать:

| Модель | Использование | Преимущества |
|--------|---------------|--------------|
| gemini-2.0-flash | Основная модель | Низкая задержка, многомодальный ввод, 1M токенов контекста |
| gemini-2.5-pro | Сложные задачи | Улучшенное мышление, анализ кода, многомодальное понимание |
| gemini-2.0-flash-lite | Ограниченные ресурсы | Оптимизирована для эффективного использования ресурсов |

## Пример конфигурации для различных сценариев

### Скрытный режим 

```python
# Минимальное потребление ресурсов, низкая заметность
gemini = APIFactory.get_gemini_integration()
gemini.gemini_model = "gemini-2.0-flash-lite"
gemini.max_tokens = 1024  # меньше токенов для быстрого ответа
gemini.temperature = 0.3  # низкая температура для детерминированных ответов
```

### Агрессивный режим

```python
# Максимальные возможности, активный сбор информации
gemini = APIFactory.get_gemini_integration()
gemini.gemini_model = "gemini-2.5-pro"
gemini.max_tokens = 8192  # больше токенов для подробных ответов
gemini.temperature = 0.8  # высокая температура для креативных решений
```

## Тестирование интеграции

Используйте скрипт `test_gemini.py` для проверки работы интеграции:

```bash
# Тестирование генерации текста
./test_gemini.py --prompt "Анализ безопасности системы" --system "Ты - эксперт по безопасности"

# Тестирование потоковой генерации
./test_gemini.py --prompt "Создай подробный отчет" --stream

# Тестирование генерации изображений
./test_gemini.py --image "Скриншот экрана с кодом и терминалом"
```

## Устранение неполадок

1. **Ошибка 400** - проверьте формат запроса и валидность API ключа
2. **Ошибка 401** - неверный или устаревший API ключ
3. **Ошибка 429** - превышение квоты или ограничения запросов
4. **Ошибка с парсингом ответа** - проверьте изменения в структуре ответа API

## Дополнительные ресурсы

- [Документация Gemini API](https://ai.google.dev/gemini-api/docs/models)
- [Примеры использования Gemini](https://github.com/GoogleCloudPlatform/generative-ai/tree/main/gemini) 